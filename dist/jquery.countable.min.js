/*! countable - v0.1.0 - 2015-07-22
* Copyright (c) 2015 light-li; Licensed MIT */
!function(a){function b(b,c){this.$element=a(b),this.options=c,this.frameVal=this.from=1*this.options.from,this.to=1*this.options.to,this.duration=this.options.duration,this.decimals=Math.max(0,this.options.decimals),this.desc=Math.pow(10,this.options.decimals),this.startTime=null;var d=a.Deferred();this.$promise=d.promise();var e=this;this.count=function(a){var b=e.from,c=e.to,f=e.duration,g=b>c;null===e.startTime&&(e.startTime=a);var h=a-e.startTime;if(g){var i=e.easeOutExpo(h,0,b-c,f);e.frameVal=i}else e.frameVal=e.easeOutExpo(h,b,c-b,f);e.frameVal=Math.round(e.frameVal*e.desc)/e.desc,g?e.frameVal=e.frameVal<c?c:e.frameVal:e.frameVal=e.frameVal>c?c:e.frameVal;var j=e.frameVal.toFixed(e.decimals);e.options.commas&&(j=e.addCommas(j)),e.$element.html(j),f>h?requestAnimationFrame(e.count):d.resolve()}}!function(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b,c){var d=(new Date).getTime(),e=Math.max(0,16-(d-a)),f=window.setTimeout(function(){b(d+e)},e);return a=d+e,f}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)})}(),b.DEFAULTS={commas:!1,decimals:0,duration:1e3},b.prototype.start=function(){if(isNaN(this.to)||isNaN(this.from))throw this.$element.html("--"),new Error("from or to is not a number");return requestAnimationFrame(this.count),!1},b.prototype.easeOutExpo=function(a,b,c,d){return c*(-Math.pow(2,-10*a/d)+1)*1024/1023+b},b.prototype.reset=function(){this.$element.html(0)},b.prototype.addCommas=function(a){var b,c,d,e;for(a+="",b=a.split("."),c=b[0],d=b.length>1?"."+b[1]:"",e=/(\d+)(\d{3})/;e.test(c);)c=c.replace(e,"$1,$2");return c+d},a.Counter=b,a.fn.countable=function(c){return a(this).each(function(){var d=a(this),e=d.data("counter"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c);e||(e=new b(this,f),d.data("counter",e)),"string"==typeof c?e[c]():f.show&&e.show()})}}(jQuery);